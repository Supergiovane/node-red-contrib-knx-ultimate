<script type="text/markdown" data-help-name="knxUltimateStaircase">
# Temporizzatore scale KNX

<p>Il nodo Temporizzatore scale KNX riproduce il classico timer luci scala. Rileva gli impulsi di attivazione, comanda l'attuatore, sincronizza lo stato tramite una GA di feedback e gestisce i comandi di override o blocco.</p>

**Indirizzi di gruppo**

|Proprietà|Descrizione|
|--|--|
| GA impulso | GA binaria che avvia il timer quando riceve `1`. Se abiliti “Il valore 0 annulla il ciclo”, lo `0` spegne immediatamente la luce. |
| GA uscita | Attuatore pilotato durante il ciclo. Seleziona il DPT coerente con il carico (binario, dimmer, analogico, …). |
| GA stato | Replica lo stato attivo e il preavviso. In modalità *Attiva GA stato* viene commutata prima dello spegnimento. |
| GA override | Mantiene la luce accesa e sospende il timer finché rimane a `1`. |
| GA blocco | Quando vale `1` ignora nuovi impulsi. L'opzione *Quando è bloccato* decide se forzare lo spegnimento. |

**Comportamento del timer**

|Opzione|Descrizione|
|--|--|
| Durata timer | Durata base del ciclo scala. |
| Nuovo impulso | Scegli se riavviare, prolungare o ignorare gli impulsi successivi. |
| Il valore 0 annulla il ciclo | Arresta il ciclo con motivo `manual-off` quando l'impulso torna a `0`. |
| Quando è bloccato | Determina se il blocco inibisce solo gli impulsi o forza lo spegnimento. |

**Preavviso**

|Opzione|Descrizione|
|--|--|
| Invia preavviso | Abilita l'avviso prima dello spegnimento. |
| Preavviso (secondi) | Quanto tempo prima della scadenza attivare l'avviso. |
| Modalità preavviso | *Attiva GA stato* commuta la GA di stato. *Lampeggia l'uscita* spegne e riaccende l'uscita dopo la durata impostata. |
| Durata lampeggio | Millisecondi durante i quali l'uscita resta spenta quando lampeggia. |

**Uscita del nodo**

- Se *Emetti eventi* è attivo il nodo emette oggetti strutturati (`trigger`, `extend`, `prewarn`, `timeout`, `override`, `block`, `manual-off`) con `remaining`, `active`, `override`, `blocked`.
- In alternativa puoi usare la GA di stato come feedback direttamente sul bus KNX.

## Ingressi

|Proprietà|Descrizione|
|--|--|
| Input dal flow | Invia `true`, `false`, `'open'` o `'close'` dal flow per avviare o interrompere il temporizzatore. |
| Telegrammi KNX | Il nodo reagisce alle GA configurate. |

## Esempio dal flow

```javascript

// Avvia il temporizzatore scale
msg.payload = true;
return msg;
```

```javascript
// Annulla il ciclo (opzione "Il valore 0 annulla il ciclo")
msg.payload = false;
return msg;
```

## Uscite

|Proprietà|Descrizione|
|--|--|
| Eventi (opzionale) | Con *Emetti eventi* attivo il nodo invia gli oggetti evento descritti sopra sull'uscita. |

</script>
